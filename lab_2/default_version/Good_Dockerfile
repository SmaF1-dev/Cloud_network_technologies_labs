FROM python:3.9-slim-buster
RUN adduser --disabled-password --gecos '' appuser \
	&& mdir /home/appuser/app \
	&& chown -R appuser:appuser /home/appuser/app
	
USER appuser
WORKDIR /home/appuser/app

COPY requirements.txt .
RUN pip install --no-cashe-dir -r requirements.txt

COPY . .

RUN find. -name ".git*" -exec rm -rf {} \;

EXPOSE 80
CMD ["python", "app.py"]
